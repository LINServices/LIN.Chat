@page "/geolocation"
@inject IJSRuntime JS

<button @onclick="RequestLocationPermission">Solicitar permiso de ubicación</button>
<button @onclick="GetLocation" disabled="@(!locationPermissionGranted)">Obtener ubicación</button>

<p>Latitud: @latitude</p>
<p>Longitud: @longitude</p>

@code {
    private double latitude;
    private double longitude;
    private bool locationPermissionGranted = false;

    private async Task RequestLocationPermission()
    {
        try
        {
            await JS.InvokeVoidAsync("getLocationPermission", DotNetObjectReference.Create(this));
        }
        catch (Exception ex)
        {
            // Manejar errores aquí
        }
    }

    [JSInvokable]
    public void LocationPermissionGranted()
    {
        locationPermissionGranted = true;
        StateHasChanged();
    }

    [JSInvokable]
    public void LocationPermissionDenied()
    {
        locationPermissionGranted = false;
        StateHasChanged();
    }

    [JSInvokable]
    public void LocationPermissionNotSupported()
    {
        // Manejar el caso en el que el navegador no soporta el permiso de geolocalización
    }

    private async Task GetLocation()
    {
        try
        {
            await JS.InvokeVoidAsync("getLocation", DotNetObjectReference.Create(this));
        }
        catch (Exception ex)
        {
            // Manejar errores aquí
        }
    }


    [JSInvokable("UpdateLocation")]
    public void A(double a, double b)
    {
        latitude = a;
        longitude = b;
        StateHasChanged();
    }
}